Как и в [[React|React]], в [[Next.js|Next.js]] используются компоненты. Однако, [[Next.js|Next.js]] разделяет компоненты на два типа:

- **Server Components**: Это компоненты, которые рендерятся исключительно на сервере. Они не имеют состояния (`state`) и не могут использовать хуки, такие как `useState` или `useEffect`. Они идеально подходят для статических частей интерфейса, загрузки данных и взаимодействия с базами данных или API. Они рендерятся один раз на сервере и не отправляются в браузер.

- **Client Components**: Это обычные [[React|React]]-компоненты. Они рендерятся на клиенте, могут иметь состояние, использовать хуки и взаимодействовать с браузером. Чтобы объявить компонент как клиентский, нужно добавить в начале файла директиву `'use client'`.

## Основные различия серверных и клиентских компонентов

Основная идея Server Components заключается в том, что они исполняются только на сервере. Это даёт несколько преимуществ:

1. **Производительность**: Поскольку Server Components не отправляются в браузер, они не увеличивают размер [[JavaScript|JavaScript]]-бандла, что ускоряет загрузку страницы.
    
2. **Безопасность**: Вы можете безопасно обращаться к чувствительным данным, таким как переменные окружения, ключи API или базы данных, прямо в Server Components, не раскрывая эту информацию клиенту.
    
3. **Упрощение логики**: Вам не нужно писать код для клиентского кэширования или API-маршрутов для получения данных. Вы можете напрямую вызывать функции для работы с базой данных или файловой системой.
    

Client Components, в свою очередь, — это обычные React-компоненты. Они исполняются в браузере и необходимы для всего, что требует интерактивности:

- Обработка событий, таких как клики, ввод в поля формы.
    
- Использование хуков, таких как `useState`, `useEffect`.
    
- Доступ к API браузера (например, `window`, `localStorage`).
    
- Динамическое обновление UI.

### Взаимодействие Server Components и Client Components

[[Next.js|Next.js]] позволяет свободно комбинировать эти два типа компонентов.

- **Server Components могут импортировать другие Server Components.** Это логично: на сервере собирается "дерево" из компонентов, которые в итоге формируют [[HTML|HTML]].
    
- **Server Components могут импортировать Client Components.** Это происходит, когда Server Component передаёт Client Component в качестве дочернего элемента (`props.children`) или напрямую импортирует его. Когда [[Next.js|Next.js]] видит такой импорт, он понимает, что эту часть нужно будет "гидратировать" на клиенте, то есть сделать интерактивной.
    
- **Client Components не могут напрямую импортировать Server Components.** Client Components существуют в браузере, а Server Components — только на сервере. Браузер ничего не знает о Server Components. Если вам нужно использовать логику Server Component внутри Client Component, вы должны передать результат Server Component в Client Component через `props`.

Пример взаимодействия серверного и клиентского компонента:

```TypeScript
'use client';
import { useState } from 'react'; 


export default function ProductList({ products }) { 
	const [cart, setCart] = useState([]); 
	const addToCart = (productId) => { setCart([...cart, productId]); }; 
	
	return ( 
		<ul> 
			{products.map((product) => ( <li key={product.id}> {product.name} {/* Интерактивная кнопка, которая может быть только в Client Component */} <button onClick={() => addToCart(product.id)}> Добавить в корзину </button> </li> ))} </ul> ); }
```